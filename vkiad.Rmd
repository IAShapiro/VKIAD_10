---
output: html_document
---
#Лабораторный практикум ВКИАД c R

**Преподаватель**
```
Дернакова Оксана Владимировна
```
**Студент**
```
Шапиро Игорь Александрович, 2 курс, 6 группа, ПМ
```
**Вариант № 10**


### Часть 1. Управление данными в R

Загрузка данных из текстового файла в таблицу данных

```{r}
qc <- read.table("QC10.txt")
```

Размерность таблицы данных

```{r}
print(dim(qc))
```

Первые 3 записи таблицы

```{r}
head(qc,3)
```

Таблица после переименования переменных

```{r}
names(qc) <- c("c1","c2", "kit", "nbug", "maker", "vendor", "c3", "c4", "bug")
head(qc)
```

Комплексная статистика по переменной vendor  
 
```{r}
summary(qc$vendor)
```

Комплексная статистика по переменной vendor после ее преобразования в переменную-фактор 

```{r}
summary(as.factor(qc$vendor))
```

Количество изделий, у которых число некритических дефектов больше 3

```{r}
sum(qc$nbug > 3)
```

Наблюдения, для которых количество некритических дефектов равно максимальному 

```{r}
qc[qc["nbug"] == max(qc$nbug),]
```


### Часть 2. Описательная статистика и графический анализ

Присоединение таблицы данных к списку текущих переменных и загрузка дополнительной библиотеки
```{r}
attach(qc)
library("e1071")
```

Выборочные среднее и медиана для переменной с1 в указанном порядке

```{r}
mean(c1)
median(c1)
```

Выборочные квартили Q1, Q2, Q3 и интерквартильный размах для c1
 
```{r}
quantile(c1, probs = c(0.25,0.50,0.75))
IQR(c1)
```

Комплексная статистика по переменной c1

```{r}
summary(c1)
```

Дисперсия для переменной с1 и переменной 2 * с1 + 100

```{r}
var(c1)
var(2 * c1 + 100)
sprintf("Вывод: отношение дисперсий равно %f", var(2 * c1 + 100) / var(c1))
```

Дисперсия для переменной с1, полученная с помощью векторного выражения

```{r}
(sum((c1 - mean(c1))^2)) / (length(c1) - 1)
```

Гистограмма для переменной с1

```{r}
hist(c1)
```

Асимметрия и эксцесс для переменной c1 в указанном порядке

```{r}
skewness(c1)
kurtosis(c1)
```
**Вывод:** Распределение переменной c1 скошено влево и имеет более тяжелые хвосты, чем у нормального распределения.

Проверка распределения переменной c1 на нормальность с помощью статистического теста Лиллиефорса

```{r}
library(nortest)
lillie.test(c1)
```
**Вывод:** Гипотеза о нормальном распределении принимается на уровне значимости 0.05.

### Часть 3. Анализ статистических зависимостей

Перекодирование переменной kit так, чтобы она принимала только два значения: 1 и 2

```{r}
kit <- ifelse(kit < 3, 1, 2)
```

Ранговый коэффициент корреляции Спирмена для переменных kit и maker. 

```{r}
cor(kit, maker, method = "spearman")
```

Таблица сопряженности по переменным kit и maker

```{r}
table(kit,maker)
```
**Выывод:** Согласно ранговому коэффициенту, близкому к 0, и таблице сопряженности согласованность между переменными практически отсутствует.

Коэффициент корреляции Для переменных c1, c3.

```{r}
cor.test(c1,c3)
```
**Вывод:** Гипотеза о равенстве нулю коэффициента корреляции между переменными отклоняется на уровне значимости 0.05 (p-value < 0.05).

Корреляционная матрица для числовых характеристик с1-c4

```{r}
myCor <- cor(qc[c("c1","c2","c3","c4")])
print(myCor)
```

Матрица корреляции в удобном представлении

```{r}
symnum(myCor)
```
**Вывод:** Наибольший коэффициент корреляции наблюдается между переменными c1 и c2.

Построение регрессионной модели по переменным c1 (зависимая - отклик) и c2 (независимая - фактор) и вывод общей статистики по результатам оценивания

```{r}
linmond = lm(formula = c1 ~ c2)
summary(linmond)
```
**Вывод:**Значим (на уровне 0.05) только коэффициент при с2. Статистика R-квадрат принимает значение 0.8182.

Диаграмма рассеяния с линией регрессии для переменных c1 и c2
```{r}
plot(c1~c2)
abline(linmond)
```

Коэффициенты регрессионной модели  

```{r}
coefficients(linmond)
```

График “Квантиль-квантиль” для остатков модели

```{r}
res = residuals(linmond)
qqnorm(res)
```
**Вывод**: Большинство точек располагаются вблизи прямой линии, поэтому распределение остатков близко к нормальному.

Тест Колмогорова-Смирнова на нормальность остатков

```{r}
ks.test(res, pnorm, mean(res), sd(res))
```
**Вывод**: Критерий принимает гипотезу о нормальном распределении остатков на уровне значимости 0.05(p-value > 0.05).

### Часть 4. Анализ неоднородных данных

Частоты значений для переменной maker.

```{r}
table(maker)
```

Двухвыборочный t-критерий по переменной, для которой наблюдается значимое различие средних в двух подвыборках (по значениям переменной maker), c разбиением на подвыборки по переменной maker

```{r}
test1 = t.test(c1 ~ maker)
test2 = t.test(c2 ~ maker)
test3 = t.test(c3 ~ maker)
test4 = t.test(c4 ~ maker)
min = min(c(test1$p.value, test2$p.value, test3$p.value, test4$p.value))
if (test1$p.value == min) test1
if (test2$p.value == min) test2
if (test3$p.value == min) test3
if (test4$p.value == min) test4
```
**Вывод:** Гипотеза о равенстве средних в двух подвыборках отклоняется на уровне значимости 0.05 (p-value < 0.05) для переменной c4 (средние значения характеристики c4 у двух производителей статистически различимы).

“Ящики с усами” для переменной c4 в разрезе по номеру производителя.

```{r}
boxplot(c4~maker)
```

График ядерной оценки плотности распределения для переменной c4

```{r}
plot(density(c4))
```
**Вывод:** Из графика видно, что выборка описывается моделью, которая представляет собой смесь двух распределений.

### Часть 5. Классификация неоднородных данных

Диаграмма рассеяния переменных c3 и c4, для которых коэффициент корреляции принимает наиболее близкое к нулю значение

```{r}
plot(c4~c3)
```

Первые 3 строки матрицы из переменных c3 и c4

```{r}
matr = cbind(c3,c4)
head(matr,3)
```

Применение кластерного анализа и вывод частот наблюдений в каждом оцененном классе

```{r}
kmres = kmeans(matr,2)
table(kmres$cluster)
```

График с классовой принадлежностью наблюдений

```{r}
plot(c4~c3, pch = ifelse(kmres$cluster == "1", 1,2))
legend("topleft", legend = c("1","2"), pch = c(1,2))
```

Работа с данными закончена

```{r}
detach(qc)
```